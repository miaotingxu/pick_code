# æ­£å¼è¯ä¹¦é…ç½®æ­¥éª¤

> **åŒ…å**: `com.mtx.take.code`  
> **å¯†ç **: `miao1234`  
> **åˆ›å»ºæ—¶é—´**: 2025-10-24

---

## ğŸ“‹ éœ€è¦å‡†å¤‡çš„æ–‡ä»¶

ä»åä¸ºå¼€å‘è€…å¹³å°ç”³è¯·è¯ä¹¦åï¼Œä½ åº”è¯¥æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š

| æ–‡ä»¶ç±»å‹ | æ–‡ä»¶åç¤ºä¾‹ | è¯´æ˜ | å¿…éœ€ |
|---------|-----------|------|------|
| **å¯†é’¥æ–‡ä»¶** | `pickcode.p12` | ç§é’¥ï¼ˆå¯èƒ½å·²æœ‰ï¼‰ | âœ… å¿…éœ€ |
| **è¯ä¹¦æ–‡ä»¶** | `pickcode.cer` æˆ– `xxx.cer` | ä»AppGalleryä¸‹è½½ | âœ… å¿…éœ€ |
| **Profileæ–‡ä»¶** | `pickcode.p7b` æˆ– `xxx.p7b` | ä»AppGalleryä¸‹è½½ | âœ… å¿…éœ€ |

---

## ğŸ” ç¬¬ä¸€æ­¥ï¼šå®šä½ä½ çš„è¯ä¹¦æ–‡ä»¶

### æ–¹æ³• 1: æ£€æŸ¥ä¸‹è½½æ–‡ä»¶å¤¹

è¯ä¹¦æ–‡ä»¶é€šå¸¸ä¸‹è½½åˆ°ï¼š

```
C:\Users\ä½ çš„ç”¨æˆ·å\Downloads\
```

æŸ¥æ‰¾æ–‡ä»¶ï¼š
- `xxx.cer` (è¯ä¹¦æ–‡ä»¶)
- `xxx.p7b` (Profileé…ç½®æ–‡ä»¶)

---

### æ–¹æ³• 2: ä» AppGallery Connect é‡æ–°ä¸‹è½½

å¦‚æœæ‰¾ä¸åˆ°æ–‡ä»¶ï¼Œå¯ä»¥é‡æ–°ä¸‹è½½ï¼š

1. ç™»å½• [AppGallery Connect](https://developer.huawei.com/consumer/cn/service/josp/agc/index.html)
2. é€‰æ‹©ä½ çš„åº”ç”¨
3. åœ¨å·¦ä¾§èœå•æ‰¾åˆ° **è¯ä¹¦ç®¡ç†**
4. ä¸‹è½½è¯ä¹¦ï¼ˆ.cerï¼‰
5. ä¸‹è½½ Profile æ–‡ä»¶ï¼ˆ.p7bï¼‰

---

## ğŸ“‚ ç¬¬äºŒæ­¥ï¼šæ•´ç†è¯ä¹¦æ–‡ä»¶

### åˆ›å»ºç­¾åç›®å½•ç»“æ„

```
F:\HarmonyOS\PickCode\signature\
â”œâ”€â”€ pickcode.p12      â† å¯†é’¥æ–‡ä»¶ï¼ˆå¦‚æœæ²¡æœ‰éœ€è¦ç”Ÿæˆï¼‰
â”œâ”€â”€ pickcode.cer      â† è¯ä¹¦æ–‡ä»¶ï¼ˆä»AppGalleryä¸‹è½½ï¼‰
â””â”€â”€ pickcode.p7b      â† Profileæ–‡ä»¶ï¼ˆä»AppGalleryä¸‹è½½ï¼‰
```

---

### å¤åˆ¶è¯ä¹¦æ–‡ä»¶åˆ°é¡¹ç›®

**å¦‚æœè¯ä¹¦æ–‡ä»¶åœ¨ä¸‹è½½æ–‡ä»¶å¤¹**ï¼š

```powershell
# å¤åˆ¶è¯ä¹¦æ–‡ä»¶åˆ°é¡¹ç›®ï¼ˆè¯·æ ¹æ®å®é™…æ–‡ä»¶åä¿®æ”¹ï¼‰
Copy-Item "$env:USERPROFILE\Downloads\ä½ çš„è¯ä¹¦.cer" -Destination "signature\pickcode.cer"
Copy-Item "$env:USERPROFILE\Downloads\ä½ çš„Profile.p7b" -Destination "signature\pickcode.p7b"
```

**æˆ–è€…æ‰‹åŠ¨å¤åˆ¶**ï¼š
1. æ‰“å¼€ `F:\HarmonyOS\PickCode\signature\` ç›®å½•
2. å°†ä¸‹è½½çš„ `.cer` å’Œ `.p7b` æ–‡ä»¶å¤åˆ¶åˆ°è¿™é‡Œ
3. é‡å‘½åä¸º `pickcode.cer` å’Œ `pickcode.p7b`ï¼ˆå»ºè®®ï¼‰

---

## ğŸ”‘ ç¬¬ä¸‰æ­¥ï¼šå‡†å¤‡å¯†é’¥æ–‡ä»¶ (.p12)

### æƒ…å†µ A: å¦‚æœä½ å·²ç»æœ‰ .p12 æ–‡ä»¶

å¦‚æœç”³è¯·è¯ä¹¦æ—¶ç”Ÿæˆäº† .p12 æ–‡ä»¶ï¼š

```powershell
# å¤åˆ¶åˆ°é¡¹ç›®
Copy-Item "ä½ çš„p12æ–‡ä»¶è·¯å¾„\xxx.p12" -Destination "signature\pickcode.p12"
```

---

### æƒ…å†µ B: å¦‚æœæ²¡æœ‰ .p12 æ–‡ä»¶ï¼Œéœ€è¦ç”Ÿæˆ

**ä½¿ç”¨ DevEco Studio ç”Ÿæˆï¼ˆæ¨èï¼‰**ï¼š

1. æ‰“å¼€ DevEco Studio
2. ç‚¹å‡»èœå• **Build** â†’ **Generate Key and CSR**
3. å¡«å†™ä¿¡æ¯ï¼š
   ```
   Key Alias:          pickcode_key
   Password:           miao1234
   Confirm Password:   miao1234
   Validity (Years):   25
   
   Certificate:
   First and Last Name:     MTX PickCode
   Organization Unit:       Development
   Organization:            MTX
   City or Locality:        Beijing
   State or Province:       Beijing
   Country Code:            CN
   ```
4. é€‰æ‹©ä¿å­˜ä½ç½®ï¼š
   ```
   F:\HarmonyOS\PickCode\signature\pickcode.p12
   ```
5. ç‚¹å‡» **OK** ç”Ÿæˆ

---

## âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½® build-profile.json5

ç¼–è¾‘é¡¹ç›®æ ¹ç›®å½•çš„ `build-profile.json5`ï¼š

```json5
{
  "app": {
    "signingConfigs": [
      {
        "name": "default",
        "type": "HarmonyOS",
        "material": {
          "storeFile": "signature/pickcode.p12",
          "storePassword": "miao1234",
          "keyAlias": "pickcode_key",
          "keyPassword": "miao1234",
          "signAlg": "SHA256withRSA",
          "certpath": "signature/pickcode.cer",
          "profile": "signature/pickcode.p7b"
        }
      },
      {
        "name": "release",
        "type": "HarmonyOS",
        "material": {
          "storeFile": "signature/pickcode.p12",
          "storePassword": "miao1234",
          "keyAlias": "pickcode_key",
          "keyPassword": "miao1234",
          "signAlg": "SHA256withRSA",
          "certpath": "signature/pickcode.cer",
          "profile": "signature/pickcode.p7b"
        }
      }
    ],
    "products": [
      {
        "name": "default",
        "signingConfig": "default",
        "targetSdkVersion": "6.0.0(20)",
        "compatibleSdkVersion": "6.0.0(20)",
        "runtimeOS": "HarmonyOS",
        "buildOption": {
          "strictMode": {
            "caseSensitiveCheck": true,
            "useNormalizedOHMUrl": true
          }
        }
      }
    ],
    "buildModeSet": [
      {
        "name": "debug",
      },
      {
        "name": "release"
      }
    ]
  },
  "modules": [
    {
      "name": "entry",
      "srcPath": "./entry",
      "targets": [
        {
          "name": "default",
          "applyToProducts": [
            "default"
          ]
        }
      ]
    }
  ]
}
```

---

## âœ… ç¬¬äº”æ­¥ï¼šéªŒè¯é…ç½®

### 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦é½å…¨

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
Get-ChildItem signature\

# åº”è¯¥çœ‹åˆ°ï¼š
# pickcode.p12  âœ…
# pickcode.cer  âœ…
# pickcode.p7b  âœ…
```

---

### 2. éªŒè¯æ–‡ä»¶æƒé™

```powershell
# ç¡®ä¿æ–‡ä»¶å¯è¯»
Test-Path signature\pickcode.p12
Test-Path signature\pickcode.cer
Test-Path signature\pickcode.p7b

# éƒ½åº”è¯¥è¿”å› True
```

---

## ğŸ”¨ ç¬¬å…­æ­¥ï¼šé‡æ–°æ„å»º

### åœ¨ DevEco Studio ä¸­ï¼š

```
1. File â†’ Invalidate Caches / Restartï¼ˆæ¸…é™¤ç¼“å­˜ï¼‰
2. Build â†’ Clean Project
3. Build â†’ Rebuild Project
4. Build â†’ Build Hap(s)
```

---

### æ„å»ºå‘å¸ƒç‰ˆæœ¬ï¼š

```
1. ç¡®ä¿ç­¾åé…ç½®æ­£ç¡®
2. Build â†’ Generate Hap(s)/App(s) â†’ Generate Signed Hap(s)
3. é€‰æ‹© "release" ç­¾åé…ç½®
4. ç‚¹å‡» OK å¼€å§‹æ‰“åŒ…
```

**è¾“å‡ºä½ç½®**ï¼š
```
entry/build/default/outputs/default/entry-default-signed.hap
```

---

## ğŸ§ª ç¬¬ä¸ƒæ­¥ï¼šæµ‹è¯•ç­¾å

### å®‰è£…åˆ°è®¾å¤‡æµ‹è¯•

```powershell
# å¸è½½æ—§ç‰ˆæœ¬
hdc uninstall com.mtx.take.code

# å®‰è£…æ–°ç­¾åçš„ç‰ˆæœ¬
hdc install entry\build\default\outputs\default\entry-default-signed.hap

# å¯åŠ¨åº”ç”¨
hdc shell aa start -a EntryAbility -b com.mtx.take.code
```

---

### éªŒè¯ç­¾åä¿¡æ¯

```powershell
# æŸ¥çœ‹åº”ç”¨ä¿¡æ¯
hdc shell bm dump -n com.mtx.take.code

# æŸ¥çœ‹ç­¾åä¿¡æ¯ï¼ˆå¦‚æœæœ‰å·¥å…·ï¼‰
# æ£€æŸ¥æ˜¯å¦æ˜¯æ­£å¼ç­¾å
```

---

## ğŸ¯ å¿«é€Ÿé…ç½®è„šæœ¬

åˆ›å»º `configure_release_signing.ps1` è„šæœ¬ï¼š

```powershell
#!/usr/bin/env pwsh
# æ­£å¼è¯ä¹¦é…ç½®è„šæœ¬

Write-Host "=====================================" -ForegroundColor Cyan
Write-Host "  æ­£å¼è¯ä¹¦é…ç½®å·¥å…·" -ForegroundColor Cyan
Write-Host "=====================================" -ForegroundColor Cyan
Write-Host ""

# æ£€æŸ¥å¿…éœ€æ–‡ä»¶
$requiredFiles = @(
    "signature\pickcode.p12",
    "signature\pickcode.cer",
    "signature\pickcode.p7b"
)

$allFilesExist = $true
foreach ($file in $requiredFiles) {
    if (Test-Path $file) {
        Write-Host "âœ“ æ‰¾åˆ°: $file" -ForegroundColor Green
    } else {
        Write-Host "âœ— ç¼ºå°‘: $file" -ForegroundColor Red
        $allFilesExist = $false
    }
}

Write-Host ""

if (-not $allFilesExist) {
    Write-Host "è¯·ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å­˜åœ¨ï¼š" -ForegroundColor Yellow
    Write-Host "  1. signature\pickcode.p12  (å¯†é’¥æ–‡ä»¶)" -ForegroundColor White
    Write-Host "  2. signature\pickcode.cer  (è¯ä¹¦æ–‡ä»¶)" -ForegroundColor White
    Write-Host "  3. signature\pickcode.p7b  (Profileæ–‡ä»¶)" -ForegroundColor White
    Write-Host ""
    Write-Host "ä» AppGallery Connect ä¸‹è½½è¯ä¹¦æ–‡ä»¶åï¼Œå¤åˆ¶åˆ° signature ç›®å½•" -ForegroundColor Cyan
    exit 1
}

Write-Host "=====================================" -ForegroundColor Green
Write-Host "  æ‰€æœ‰è¯ä¹¦æ–‡ä»¶å·²å°±ç»ªï¼" -ForegroundColor Green
Write-Host "=====================================" -ForegroundColor Green
Write-Host ""
Write-Host "ä¸‹ä¸€æ­¥ï¼š" -ForegroundColor Yellow
Write-Host "1. åœ¨ DevEco Studio ä¸­ï¼šBuild â†’ Clean Project" -ForegroundColor White
Write-Host "2. Build â†’ Rebuild Project" -ForegroundColor White
Write-Host "3. Build â†’ Generate Signed Hap(s)" -ForegroundColor White
Write-Host ""
```

**ä½¿ç”¨æ–¹æ³•**ï¼š

```powershell
.\configure_release_signing.ps1
```

---

## ğŸ“ é…ç½®ç¤ºä¾‹

### å®Œæ•´çš„ç­¾åé…ç½®

**ç›®å½•ç»“æ„**ï¼š
```
F:\HarmonyOS\PickCode\
â”œâ”€â”€ signature\
â”‚   â”œâ”€â”€ pickcode.p12      â† å¯†é’¥ï¼ˆå¯†ç : miao1234ï¼‰
â”‚   â”œâ”€â”€ pickcode.cer      â† ä»AppGalleryä¸‹è½½
â”‚   â””â”€â”€ pickcode.p7b      â† ä»AppGalleryä¸‹è½½
â”œâ”€â”€ build-profile.json5   â† å·²é…ç½®ç­¾åä¿¡æ¯
â””â”€â”€ AppScope\
    â””â”€â”€ app.json5         â† bundleName: com.mtx.take.code
```

**ç­¾åå‚æ•°**ï¼š
```
Store File:      signature/pickcode.p12
Store Password:  miao1234
Key Alias:       pickcode_key
Key Password:    miao1234
Cert Path:       signature/pickcode.cer
Profile:         signature/pickcode.p7b
Sign Algorithm:  SHA256withRSA
```

---

## âš ï¸ é‡è¦æç¤º

### 1. è¯ä¹¦æ–‡ä»¶ä¿å¯†

```gitignore
# .gitignore å·²é…ç½®ï¼Œä»¥ä¸‹æ–‡ä»¶ä¸ä¼šæäº¤åˆ° Gitï¼š
signature/*.p12   âœ…
signature/*.cer   âœ…
signature/*.p7b   âœ…
*.p12            âœ…
material/        âœ…
```

### 2. å¯†ç å®‰å…¨

- âœ… å¯†ç å·²çŸ¥ï¼š`miao1234`
- âš ï¸ ä¸è¦æ³„éœ²ç»™ä»–äºº
- âš ï¸ ä¸è¦åœ¨å…¬å¼€æ¸ é“åˆ†äº«
- âœ… å‘å¸ƒç‰ˆæœ¬å¯è€ƒè™‘ä½¿ç”¨æ›´å¼ºçš„å¯†ç 

### 3. è¯ä¹¦æœ‰æ•ˆæœŸ

- æ£€æŸ¥è¯ä¹¦æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…
- è¯ä¹¦è¿‡æœŸéœ€è¦é‡æ–°ç”³è¯·
- Profile æ–‡ä»¶é€šå¸¸æœ‰æ•ˆæœŸä¸º 1 å¹´

### 4. Bundle Name åŒ¹é…

ç¡®ä¿ AppGallery Connect ä¸­çš„åº”ç”¨åŒ…åä¸é¡¹ç›®ä¸€è‡´ï¼š
```
AppGallery: com.mtx.take.code
é¡¹ç›®é…ç½®:   com.mtx.take.code  âœ… åŒ¹é…
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: "ç­¾åå¤±è´¥ - è¯ä¹¦ä¸åŒ¹é…"

**åŸå› **ï¼šè¯ä¹¦çš„åŒ…åä¸é¡¹ç›®ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ AppGallery Connect ä¸­çš„åº”ç”¨åŒ…å
2. æ£€æŸ¥ `AppScope/app.json5` ä¸­çš„ `bundleName`
3. ç¡®ä¿å®Œå…¨ä¸€è‡´

---

### é—®é¢˜ 2: "Profile æ–‡ä»¶æ— æ•ˆ"

**åŸå› **ï¼šProfile æ–‡ä»¶è¿‡æœŸæˆ–ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç™»å½• AppGallery Connect
2. é‡æ–°ä¸‹è½½æœ€æ–°çš„ Profile æ–‡ä»¶
3. æ›¿æ¢ `signature/pickcode.p7b`

---

### é—®é¢˜ 3: "å¯†é’¥åº“å¯†ç é”™è¯¯"

**åŸå› **ï¼šå¯†ç ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤å¯†ç ï¼š`miao1234`
2. æ£€æŸ¥ `build-profile.json5` ä¸­çš„å¯†ç é…ç½®
3. å¦‚æœå¯†ç ç¡®å®ä¸å¯¹ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆå¯†é’¥æ–‡ä»¶

---

### é—®é¢˜ 4: "æ‰¾ä¸åˆ°ç­¾åæ–‡ä»¶"

**åŸå› **ï¼šæ–‡ä»¶è·¯å¾„ä¸å¯¹

**è§£å†³æ–¹æ¡ˆ**ï¼š
```powershell
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
Test-Path signature\pickcode.p12
Test-Path signature\pickcode.cer
Test-Path signature\pickcode.p7b

# æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰
```

---

## âœ… é…ç½®å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] å·²ä» AppGallery Connect ä¸‹è½½è¯ä¹¦æ–‡ä»¶ (.cer)
- [ ] å·²ä» AppGallery Connect ä¸‹è½½ Profile æ–‡ä»¶ (.p7b)
- [ ] å·²æœ‰æˆ–å·²ç”Ÿæˆå¯†é’¥æ–‡ä»¶ (.p12)
- [ ] æ‰€æœ‰æ–‡ä»¶å·²å¤åˆ¶åˆ° `signature/` ç›®å½•
- [ ] æ–‡ä»¶åæ­£ç¡®ï¼špickcode.p12, pickcode.cer, pickcode.p7b
- [ ] å·²é…ç½® `build-profile.json5`
- [ ] å¯†ç æ­£ç¡®ï¼šmiao1234
- [ ] åŒ…ååŒ¹é…ï¼šcom.mtx.take.code
- [ ] å·²æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®
- [ ] èƒ½æˆåŠŸç”Ÿæˆç­¾åçš„ HAP åŒ…
- [ ] ç­¾åçš„ HAP åŒ…èƒ½æˆåŠŸå®‰è£…åˆ°è®¾å¤‡

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

### å¦‚æœè¯ä¹¦æ–‡ä»¶æ‰¾ä¸åˆ°ï¼š

è¯·å‘Šè¯‰æˆ‘è¯ä¹¦æ–‡ä»¶çš„ä½ç½®ï¼Œæˆ‘å¯ä»¥å¸®ä½ ï¼š
1. å¤åˆ¶æ–‡ä»¶åˆ°æ­£ç¡®çš„ä½ç½®
2. é…ç½® build-profile.json5
3. éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®

### å¦‚æœé…ç½®é‡åˆ°é—®é¢˜ï¼š

æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
- é”™è¯¯æç¤ºä¿¡æ¯
- å½“å‰ signature ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨
- build-profile.json5 çš„é…ç½®å†…å®¹

---

**å½“å‰é…ç½®ä¿¡æ¯**ï¼š
- åŒ…åï¼š`com.mtx.take.code`
- å¯†ç ï¼š`miao1234`
- å¯†é’¥åˆ«åï¼š`pickcode_key`

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-10-24  
**çŠ¶æ€**: âœ… å¾…é…ç½®

