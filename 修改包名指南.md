# HarmonyOS 应用包名修改完整指南

> **当前包名**: `com.example.first`  
> **创建时间**: 2025-10-24

---

## 📦 当前包名

### 你的应用包名是：`com.example.first`

**配置位置**：`AppScope/app.json5`

```json5
{
  "app": {
    "bundleName": "com.example.first",  // ← 当前包名
    "vendor": "example",
    "versionCode": 1000000,
    "versionName": "1.0.0",
    "icon": "$media:big_logo",
    "label": "$string:app_name"
  }
}
```

---

## 🔧 如何修改包名

### 只需修改 1 个文件！⭐

HarmonyOS 应用的包名只在一个地方配置：

#### `AppScope/app.json5`

```json5
{
  "app": {
    "bundleName": "你的新包名",  // ← 只需修改这里
    "vendor": "你的厂商名",
    "versionCode": 1000000,
    "versionName": "1.0.0",
    "icon": "$media:big_logo",
    "label": "$string:app_name"
  }
}
```

---

## 📝 包名命名规范

### ✅ 正确的包名格式

```
格式：com.公司名.应用名
或：  com.个人标识.应用名

推荐示例：
✅ com.pickcode.app        快递取件码应用
✅ com.take.parcel         取件助手
✅ com.express.manager     快递管理器
✅ com.mycompany.delivery  我的快递
```

### 📏 命名规则

| 规则 | 说明 | 示例 |
|------|------|------|
| ✅ 小写字母 | 必须全部小写 | `com.pickcode.app` ✓ |
| ✅ 数字 | 可以包含数字 | `com.app123.tool` ✓ |
| ✅ 点号分隔 | 至少两段 | `com.myapp` ✓ |
| ❌ 大写字母 | 不允许大写 | `com.PickCode.App` ✗ |
| ❌ 下划线 | 不允许下划线 | `com.pick_code.app` ✗ |
| ❌ 连字符 | 不允许连字符 | `com.pick-code.app` ✗ |
| ❌ 数字开头 | 段不能以数字开头 | `com.123app.tool` ✗ |

### 详细示例

```
✅ 正确的包名：
com.pickcode.app
com.abc.xyz
com.company123.app
com.my.simple.app
com.huawei.pickcode

❌ 错误的包名：
Com.PickCode.App         （包含大写字母）
com.pick-code.app        （包含连字符）
com.pick_code.app        （包含下划线）
com.123company.app       （数字开头）
pickcode                 （只有一段）
com.Pick Code.app        （包含空格）
com.快递.app             （包含中文）
```

---

## 🚀 修改包名的完整步骤

### 步骤 1: 修改配置文件

编辑 `AppScope/app.json5`：

**修改前**：
```json5
{
  "app": {
    "bundleName": "com.example.first",
    "vendor": "example",
    ...
  }
}
```

**修改后**（以 `com.pickcode.app` 为例）：
```json5
{
  "app": {
    "bundleName": "com.pickcode.app",  // ← 新包名
    "vendor": "PickCode",               // ← 建议同步修改
    ...
  }
}
```

---

### 步骤 2: 清理旧构建

**方式 A：在 DevEco Studio 中**
```
菜单栏 → Build → Clean Project
```

**方式 B：使用命令行**
```powershell
hvigorw clean
```

**方式 C：手动删除**
```powershell
Remove-Item entry\build -Recurse -Force -ErrorAction SilentlyContinue
```

---

### 步骤 3: 卸载设备上的旧应用

**重要**：修改包名后，系统会认为这是一个全新的应用！

```powershell
# 卸载旧包名的应用
hdc uninstall com.example.first

# 如果找不到 hdc 命令，使用完整路径
& "C:\Users\你的用户名\AppData\Local\Huawei\Sdk\openharmony\11\toolchains\hdc.exe" uninstall com.example.first
```

**或在设备上手动卸载**：
```
设置 → 应用管理 → 找到应用 → 卸载
```

---

### 步骤 4: 重新构建项目

**方式 A：DevEco Studio（推荐）**
```
1. Build → Rebuild Project
2. Build → Build Hap(s)
```

**方式 B：命令行**
```powershell
hvigorw assembleHap --mode module -p module=entry -p product=default
```

---

### 步骤 5: 安装新应用

**方式 A：DevEco Studio（最简单）⭐**
```
点击 Run 按钮（Shift + F10）
```

**方式 B：命令行**
```powershell
hdc install entry\build\default\outputs\default\entry-default-unsigned.hap
```

---

### 步骤 6: 验证新包名

```powershell
# 查看已安装的应用
hdc shell bm dump -a | findstr "com.pickcode.app"

# 查看应用详细信息
hdc shell bm dump -n com.pickcode.app

# 启动应用
hdc shell aa start -a EntryAbility -b com.pickcode.app
```

---

## ⚠️ 重要提示

### 修改包名的影响

#### 1. 新旧应用互不影响

```
旧应用：com.example.first  ← 独立存在
新应用：com.pickcode.app   ← 全新应用

- 可以同时安装在同一设备上
- 数据完全独立
- 图标和名称可以相同
```

#### 2. 数据不会自动迁移

```
旧应用的数据：
├─ 数据库 (ParcelDatabase)
├─ 配置文件
└─ 用户数据

修改包名后 → 新应用从零开始
```

如需迁移数据，需要自己编写数据导出/导入功能。

#### 3. 签名配置

**自动签名**：
- ✅ 通常不受影响
- ✅ DevEco Studio 会自动处理

**手动签名**：
- ⚠️ 可能需要重新配置
- ⚠️ 需要更新证书中的包名

#### 4. 应用市场发布

```
⚠️ 已发布的应用：
- 不建议修改包名
- 修改后会被视为新应用
- 用户需要重新下载安装
- 无法通过更新升级

✅ 未发布的应用：
- 可以自由修改
- 选择一个合适的包名
- 发布前确定最终包名
```

---

## 📊 包名修改对比

| 项目 | 修改前 | 修改后 |
|------|--------|--------|
| **Bundle Name** | `com.example.first` | `com.pickcode.app` |
| **应用标识** | 旧应用 | 新应用（独立） |
| **数据存储** | `/data/.../com.example.first/` | `/data/.../com.pickcode.app/` |
| **安装行为** | 覆盖安装 | 全新安装 |
| **卸载命令** | `hdc uninstall com.example.first` | `hdc uninstall com.pickcode.app` |
| **启动命令** | `aa start -b com.example.first` | `aa start -b com.pickcode.app` |

---

## 🎯 推荐的包名

### 对于你的快递取件码应用

根据应用功能，推荐以下包名：

```
1️⃣ com.pickcode.app          （简洁直接）⭐
2️⃣ com.express.pickup        （快递取件）
3️⃣ com.parcel.manager        （包裹管理）
4️⃣ com.courier.code          （快递代码）
5️⃣ com.delivery.assistant    （配送助手）
```

### 选择建议

- ✅ **简短易记**：便于用户识别
- ✅ **语义清晰**：一看就知道是什么应用
- ✅ **专业规范**：符合行业习惯
- ✅ **便于搜索**：容易在应用商店找到

---

## 🔍 常见问题

### Q1: 修改包名后原来的数据会丢失吗？

**答**：不会丢失，但新应用访问不到旧数据。

- 旧应用的数据仍然存在（如果未卸载）
- 新应用有独立的数据存储路径
- 如需迁移，需要手动导出/导入

### Q2: 能否修改包名后保留用户数据？

**答**：不能自动保留，但可以实现数据迁移：

```typescript
// 1. 在新应用中添加数据导入功能
// 2. 用户手动导出旧应用数据
// 3. 在新应用中导入数据
```

### Q3: 修改包名需要重新签名吗？

**答**：
- **自动签名**：不需要，DevEco Studio 自动处理
- **手动签名**：可能需要，检查证书配置

### Q4: 修改包名会影响权限申请吗？

**答**：不会。权限配置在 `module.json5` 中，与包名无关。

```json5
// entry/src/main/module.json5
{
  "module": {
    "requestPermissions": [
      // 这些配置不受包名影响
      {"name": "ohos.permission.CAMERA"},
      {"name": "ohos.permission.READ_MESSAGES"}
    ]
  }
}
```

### Q5: 开发阶段可以随意修改包名吗？

**答**：可以，但建议：

- ✅ 在项目初期确定包名
- ✅ 避免频繁修改
- ✅ 正式发布前最后确认

---

## ✅ 修改包名检查清单

修改包名前，请确认：

- [ ] 已备份重要数据（如有必要）
- [ ] 已选择合适的新包名
- [ ] 新包名符合命名规范
- [ ] 已卸载设备上的旧应用
- [ ] 已清理旧的构建文件
- [ ] 已修改 `AppScope/app.json5`
- [ ] 已重新构建项目
- [ ] 已测试新应用功能正常
- [ ] 已验证权限授权正常
- [ ] （发布前）已确认最终包名

---

## 📝 快速修改脚本

创建 `change_bundlename.ps1` 脚本快速修改：

```powershell
#!/usr/bin/env pwsh
# 快速修改包名脚本

param(
    [Parameter(Mandatory=$true)]
    [string]$NewBundleName
)

Write-Host "=====================================" -ForegroundColor Cyan
Write-Host "  HarmonyOS 包名修改工具" -ForegroundColor Cyan
Write-Host "=====================================" -ForegroundColor Cyan
Write-Host ""

# 验证包名格式
if ($NewBundleName -notmatch '^[a-z][a-z0-9]*(\.[a-z][a-z0-9]*)+$') {
    Write-Host "✗ 包名格式错误！" -ForegroundColor Red
    Write-Host ""
    Write-Host "正确格式：com.公司名.应用名" -ForegroundColor Yellow
    Write-Host "示例：com.pickcode.app" -ForegroundColor White
    exit 1
}

Write-Host "新包名: $NewBundleName" -ForegroundColor Green
Write-Host ""

# 读取旧包名
$appJson = Get-Content "AppScope\app.json5" -Raw
if ($appJson -match '"bundleName":\s*"([^"]+)"') {
    $OldBundleName = $Matches[1]
    Write-Host "旧包名: $OldBundleName" -ForegroundColor Yellow
    Write-Host ""
} else {
    Write-Host "✗ 无法读取旧包名" -ForegroundColor Red
    exit 1
}

# 确认修改
$confirm = Read-Host "确认修改？(y/n)"
if ($confirm -ne 'y') {
    Write-Host "已取消" -ForegroundColor Yellow
    exit 0
}

# 修改 app.json5
Write-Host ""
Write-Host "[1/4] 修改配置文件..." -ForegroundColor Yellow
$newContent = $appJson -replace $OldBundleName, $NewBundleName
Set-Content "AppScope\app.json5" -Value $newContent -NoNewline
Write-Host "✓ 配置已更新" -ForegroundColor Green

# 清理构建
Write-Host ""
Write-Host "[2/4] 清理旧构建..." -ForegroundColor Yellow
Remove-Item "entry\build" -Recurse -Force -ErrorAction SilentlyContinue
Write-Host "✓ 清理完成" -ForegroundColor Green

# 卸载旧应用
Write-Host ""
Write-Host "[3/4] 卸载旧应用..." -ForegroundColor Yellow
Write-Host "请手动执行：hdc uninstall $OldBundleName" -ForegroundColor Cyan

# 提示重新构建
Write-Host ""
Write-Host "[4/4] 下一步操作..." -ForegroundColor Yellow
Write-Host "1. 在 DevEco Studio 中：Build → Rebuild Project" -ForegroundColor White
Write-Host "2. 点击 Run 按钮（Shift + F10）安装新应用" -ForegroundColor White
Write-Host ""
Write-Host "✓ 包名修改完成！" -ForegroundColor Green
Write-Host ""
```

**使用方法**：

```powershell
# 修改包名为 com.pickcode.app
.\change_bundlename.ps1 -NewBundleName "com.pickcode.app"
```

---

## 📞 相关文档

- 📄 `启动错误修复指南.md` - 应用启动问题排查
- 📄 `打包安装说明.md` - 应用打包和安装
- 📄 `重新打包指南.md` - 重新构建项目
- 📄 [HarmonyOS 官方文档](https://developer.harmonyos.com/)

---

**当前包名**: `com.example.first`  
**推荐修改为**: `com.pickcode.app` 或其他符合你应用的包名

**最简单的修改方式**: 在 DevEco Studio 中直接编辑 `AppScope/app.json5`！

---

**文档版本**: v1.0  
**创建时间**: 2025-10-24  
**状态**: ✅ 可用

